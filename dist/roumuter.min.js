!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).ReactLightState=e()}(this,function(){"use strict";var t=function(){function t(t){this.cbs=[],this.data=t}var e=t.prototype;return e.setData=function(t){this.data=t;for(var e=this.cbs.length-1;e>=0;e--)this.cbs[e]&&this.cbs[e](t)},e.getData=function(){return this.data},e.subscribe=function(t){this.cbs.push(t)},e.unsubscribe=function(t){var e=this.cbs.indexOf(t);~e&&this.cbs.splice(e,1)},e.unSubscribeAll=function(){this.cbs=[]},t}(),e=t=>encodeURIComponent(t).replace(/[!'()*]/g,t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`),r=/%[a-f0-9]{2}/gi,n=/(%[a-f0-9]{2})+/gi;function o(t,e){try{return decodeURIComponent(t.join(""))}catch(t){}if(1===t.length)return t;var r=t.slice(0,e=e||1),n=t.slice(e);return Array.prototype.concat.call([],o(r),o(n))}function i(t){try{return decodeURIComponent(t)}catch(i){for(var e=t.match(r),n=1;e.length>n;n++)e=(t=o(e,n).join("")).match(r);return t}}var c=function(t){if("string"!=typeof t)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch(e){return function(t){for(var e={"%FE%FF":"��","%FF%FE":"��"},r=n.exec(t);r;){try{e[r[0]]=decodeURIComponent(r[0])}catch(t){var o=i(r[0]);o!==r[0]&&(e[r[0]]=o)}r=n.exec(t)}e["%C2"]="�";for(var c=Object.keys(e),a=0;c.length>a;a++){var s=c[a];t=t.replace(RegExp(s,"g"),e[s])}return t}(t)}},a=(t,e)=>{if("string"!=typeof t||"string"!=typeof e)throw new TypeError("Expected the arguments to be of type `string`");if(""===e)return[t];const r=t.indexOf(e);return-1===r?[t]:[t.slice(0,r),t.slice(r+e.length)]};function s(t,r){return r.encode?r.strict?e(t):encodeURIComponent(t):t}function u(t,e){return e.decode?c(t):t}function f(t){const e=t.indexOf("#");return-1!==e&&(t=t.slice(0,e)),t}function l(t){const e=(t=f(t)).indexOf("?");return-1===e?"":t.slice(e+1)}function d(t,e){const r=function(t){let e;switch(t.arrayFormat){case"index":return(t,r,n)=>{e=/\[(\d*)\]$/.exec(t),t=t.replace(/\[\d*\]$/,""),e?(void 0===n[t]&&(n[t]={}),n[t][e[1]]=r):n[t]=r};case"bracket":return(t,r,n)=>{e=/(\[\])$/.exec(t),t=t.replace(/\[\]$/,""),n[t]=e?void 0!==n[t]?[].concat(n[t],r):[r]:r};case"comma":return(t,e,r)=>{const n="string"==typeof e&&e.split("").indexOf(",")>-1?e.split(","):e;r[t]=n};default:return(t,e,r)=>{r[t]=void 0!==r[t]?[].concat(r[t],e):e}}}(e=Object.assign({decode:!0,arrayFormat:"none"},e)),n=Object.create(null);if("string"!=typeof t)return n;if(!(t=t.trim().replace(/^[?#&]/,"")))return n;for(const o of t.split("&")){let[t,i]=a(o.replace(/\+/g," "),"=");i=void 0===i?null:u(i,e),r(u(t,e),i,n)}return Object.keys(n).sort().reduce((t,e)=>{const r=n[e];return t[e]=r&&"object"==typeof r&&!Array.isArray(r)?function t(e){return Array.isArray(e)?e.sort():"object"==typeof e?t(Object.keys(e)).sort((t,e)=>+t-+e).map(t=>e[t]):e}(r):r,t},Object.create(null))}var p={extract:l,parse:d,stringify:(t,e)=>{if(!t)return"";const r=function(t){switch(t.arrayFormat){case"index":return e=>(r,n)=>{const o=r.length;return void 0===n?r:null===n?[...r,s(e,t)+"["+o+"]"]:[...r,s(e,t)+"["+s(o,t)+"]="+s(n,t)]};case"bracket":return e=>(r,n)=>void 0===n?r:null===n?[...r,s(e,t)+"[]"]:[...r,s(e,t)+"[]="+s(n,t)];case"comma":return e=>(r,n,o)=>null==n||0===n.length?r:0===o?[s(e,t)+"="+s(n,t)]:[[r,s(n,t)].join(",")];default:return e=>(r,n)=>void 0===n?r:null===n?[...r,s(e,t)]:[...r,s(e,t)+"="+s(n,t)]}}(e=Object.assign({encode:!0,strict:!0,arrayFormat:"none"},e)),n=Object.keys(t);return!1!==e.sort&&n.sort(e.sort),n.map(n=>{const o=t[n];return void 0===o?"":null===o?s(n,e):Array.isArray(o)?o.reduce(r(n),[]).join("&"):s(n,e)+"="+s(o,e)}).filter(t=>t.length>0).join("&")},parseUrl:(t,e)=>({url:f(t).split("?")[0]||"",query:d(l(t),e)})},h="undefined"!=typeof global,y="undefined"!=typeof window||h&&void 0!==global.window;return function(){function e(e){var r=void 0===e?{}:e,n=r.params;this.path=r.path,this.params=n||[],this.Store=new t({})}var r=e.prototype;return r.init=function(){if(y){var t=p.parse(window.location.search);this.Store.setData(this.filterParams(t))}},r.navigate=function(t){this.Store.setData(this.filterParams(t))},r.subscribe=function(t){this.Store.subscribe(t)},r.filterParams=function(t){var e=this;if(void 0===t&&(t={}),Array.isArray(this.params)){var r={};return Object.keys(t).filter(function(t){return e.params.includes(t)}).forEach(function(e){r[e]=t[e]}),r}return{}},e}()});
