!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).Roumuter=e()}(this,function(){"use strict";function t(){return(t=Object.assign||function(t){for(var e=1;arguments.length>e;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}var e=function(){function t(t){this.cbs=[],this.data=t}var e=t.prototype;return e.setData=function(t){this.data=t;for(var e=this.cbs.length-1;e>=0;e--)this.cbs[e]&&this.cbs[e](t)},e.getData=function(){return this.data},e.subscribe=function(t){this.cbs.push(t)},e.unsubscribe=function(t){var e=this.cbs.indexOf(t);~e&&this.cbs.splice(e,1)},e.unSubscribeAll=function(){this.cbs=[]},t}(),r=t=>encodeURIComponent(t).replace(/[!'()*]/g,t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`),n=/%[a-f0-9]{2}/gi,i=/(%[a-f0-9]{2})+/gi;function o(t,e){try{return decodeURIComponent(t.join(""))}catch(t){}if(1===t.length)return t;var r=t.slice(0,e=e||1),n=t.slice(e);return Array.prototype.concat.call([],o(r),o(n))}function a(t){try{return decodeURIComponent(t)}catch(i){for(var e=t.match(n),r=1;e.length>r;r++)e=(t=o(e,r).join("")).match(n);return t}}var s=function(t){if("string"!=typeof t)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch(e){return function(t){for(var e={"%FE%FF":"��","%FF%FE":"��"},r=i.exec(t);r;){try{e[r[0]]=decodeURIComponent(r[0])}catch(t){var n=a(r[0]);n!==r[0]&&(e[r[0]]=n)}r=i.exec(t)}e["%C2"]="�";for(var o=Object.keys(e),s=0;o.length>s;s++){var c=o[s];t=t.replace(RegExp(c,"g"),e[c])}return t}(t)}},c=(t,e)=>{if("string"!=typeof t||"string"!=typeof e)throw new TypeError("Expected the arguments to be of type `string`");if(""===e)return[t];const r=t.indexOf(e);return-1===r?[t]:[t.slice(0,r),t.slice(r+e.length)]};function u(t,e){return e.encode?e.strict?r(t):encodeURIComponent(t):t}function f(t,e){return e.decode?s(t):t}function l(t){const e=t.indexOf("#");return-1!==e&&(t=t.slice(0,e)),t}function p(t){const e=(t=l(t)).indexOf("?");return-1===e?"":t.slice(e+1)}function h(t,e){const r=function(t){let e;switch(t.arrayFormat){case"index":return(t,r,n)=>{e=/\[(\d*)\]$/.exec(t),t=t.replace(/\[\d*\]$/,""),e?(void 0===n[t]&&(n[t]={}),n[t][e[1]]=r):n[t]=r};case"bracket":return(t,r,n)=>{e=/(\[\])$/.exec(t),t=t.replace(/\[\]$/,""),n[t]=e?void 0!==n[t]?[].concat(n[t],r):[r]:r};case"comma":return(t,e,r)=>{const n="string"==typeof e&&e.split("").indexOf(",")>-1?e.split(","):e;r[t]=n};default:return(t,e,r)=>{r[t]=void 0!==r[t]?[].concat(r[t],e):e}}}(e=Object.assign({decode:!0,arrayFormat:"none"},e)),n=Object.create(null);if("string"!=typeof t)return n;if(!(t=t.trim().replace(/^[?#&]/,"")))return n;for(const i of t.split("&")){let[t,o]=c(i.replace(/\+/g," "),"=");o=void 0===o?null:f(o,e),r(f(t,e),o,n)}return Object.keys(n).sort().reduce((t,e)=>{const r=n[e];return t[e]=r&&"object"==typeof r&&!Array.isArray(r)?function t(e){return Array.isArray(e)?e.sort():"object"==typeof e?t(Object.keys(e)).sort((t,e)=>+t-+e).map(t=>e[t]):e}(r):r,t},Object.create(null))}var d={extract:p,parse:h,stringify:(t,e)=>{if(!t)return"";const r=function(t){switch(t.arrayFormat){case"index":return e=>(r,n)=>{const i=r.length;return void 0===n?r:null===n?[...r,u(e,t)+"["+i+"]"]:[...r,u(e,t)+"["+u(i,t)+"]="+u(n,t)]};case"bracket":return e=>(r,n)=>void 0===n?r:null===n?[...r,u(e,t)+"[]"]:[...r,u(e,t)+"[]="+u(n,t)];case"comma":return e=>(r,n,i)=>null==n||0===n.length?r:0===i?[u(e,t)+"="+u(n,t)]:[[r,u(n,t)].join(",")];default:return e=>(r,n)=>void 0===n?r:null===n?[...r,u(e,t)]:[...r,u(e,t)+"="+u(n,t)]}}(e=Object.assign({encode:!0,strict:!0,arrayFormat:"none"},e)),n=Object.keys(t);return!1!==e.sort&&n.sort(e.sort),n.map(n=>{const i=t[n];return void 0===i?"":null===i?u(n,e):Array.isArray(i)?i.reduce(r(n),[]).join("&"):u(n,e)+"="+u(i,e)}).filter(t=>t.length>0).join("&")},parseUrl:(t,e)=>({url:l(t).split("?")[0]||"",query:h(p(t),e)})},y="undefined"!=typeof global,b="undefined"!=typeof window||y&&void 0!==global.window;return function(){function r(t){var r=void 0===t?{}:t,n=r.params;this.path=r.path||(b?window.location.pathname:""),this.params=n||[],this.Store=new e({})}var n=r.prototype;return n.init=function(){if(b){var t=d.parse(window.location.search);this.Store.setData(this.filterParams(t))}},n.navigate=function(e){var r=t({},this.Store.getData(),e);b&&window.history.pushState(null,null,this.path+"?"+d.stringify(r)),this.Store.setData(this.filterParams(r))},n.navigate_remove=function(t,e){var r=this,n=this.Store.getData(),i=Object.assign({},n);Object.keys(t).forEach(function(n){var o=t[n];if(i.hasOwnProperty(n))if(e){var a=i[n].split(",");a.splice(a.findIndex(function(t){return t===o}),1),i[n]=a.join(",")}else i[n]=null;window.history.pushState(null,null,r.path+"?"+d.stringify(i)),r.Store.setData(r.filterParams(i))})},n.reset=function(){b&&window.history.pushState(null,null,this.path+"?"+d.stringify(this.params)),this.Store.setData(this.filterParams(this.params))},n.subscribe=function(t){this.Store.subscribe(t)},n.getSearchParmas=function(){return this.Store.data},n.filterParams=function(t){var e=this;if(void 0===t&&(t={}),Array.isArray(this.params)){var r={};return Object.keys(t).filter(function(t){return e.params.includes(t)}).forEach(function(e){r[e]=t[e]}),r}if("object"==typeof this.params){if(0!==Object.keys(t).length){r={};return Object.keys(t).filter(function(t){return Object.keys(e.params).includes(t)}).forEach(function(e){r[e]=t[e]}),r}return this.params}return{}},r}()});
